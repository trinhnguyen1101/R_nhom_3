---
title: "ĐỒ ÁN CUỐI KỲ"
output: html_document
date: "2025-05-09"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(dplyr)
library(ggplot2)
library(broom)
```

```{r}
## Đọc dữ liệu từ file CSV
all <- read.csv(file.choose())
```

```{r}
## Làm sạch dữ liệu
# Xóa cột 'page'
all$page <- NULL
# Dữ liệu có thể chứa cột page không cần thiết cho việc phân tích, nên ta loại bỏ nó để gọn gàng hơn.

# Loại bỏ các dòng trống
#all$money <- gsub("[^0-9.-]", "", all$money) # Xóa ký tự không phải số
all$money <- as.numeric(all$money) # Chuyển đổi giá trị money thành dạng số thực
all <- subset(all, !is.na(desc) & desc != "" & !is.na(money) & money > 0)
print(all)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
## Thống kê mô tả
# Thống kê cho cột money 
money_summary <- c(
  Min = format(min(all$money, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Q1 = format(quantile(all$money, 0.25, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Median = format(median(all$money, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Mean = format(round(mean(all$money, na.rm = TRUE)), scientific = FALSE, trim = TRUE),
  Q3 = format(quantile(all$money, 0.75, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Max = format(max(all$money, na.rm = TRUE), scientific = FALSE, trim = TRUE)
)
print("Thống kê cột money:")
print(money_summary)

# Thống kê mô tả cho các cột còn lại (date, bank, id, desc)
all$id <- as.character(all$id)  # Chuyển id thành character để định dạng giống date, bank, desc
stat_desc <- summary(all[, c("date", "bank", "id", "desc")])
print(stat_desc)
```

Thống kê 6 giá trị mô tả trung tâm và phân bố của biến money:

  Min: Giá trị nhỏ nhất

  Q1: Phân vị thứ 25

  Median: Trung vị 

  Mean: Trung bình

  Q3: Phân vị thứ 75

  Max: Giá trị lớn nhất

```{r}
## Thống Kê Suy Diễn
# 1. Khoảng tin cậy 95% cho trung bình money
n <- length(all$money)
mean_money <- mean(all$money, na.rm = TRUE)
sd_money <- sd(all$money, na.rm = TRUE)
se_money <- sd_money / sqrt(n)  # Sai số chuẩn
ci_95 <- c(
  Lower = mean_money - qnorm(0.975) * se_money,
  Upper = mean_money + qnorm(0.975) * se_money
)
cat("Khoảng tin cậy 95% cho trung bình money:\n")
cat("Lower:", round(ci_95["Lower"]), "Upper:", round(ci_95["Upper"]), "\n\n")
```

Mục đích: Ước lượng phạm vi mà trung bình số tiền ủng hộ của tổng thể (tất cả giao dịch ủng hộ bão Yagi) với độ tin cậy 95%.

Kết quả: Khoảng tin cậy 95% cho trung bình money: Lower: 681765 Upper: 690217

Điều này cho thấy ràng quy mô ủng hộ bão Yagi dao động quanh 681,765 - 690,217 (VNĐ) với độ tin cậy cao.

```{r}
# 2. Kiểm định t một mẫu: Trung bình money có bằng 500,000 không?
t_test <- t.test(all$money, mu = 500000, conf.level = 0.95)
cat("Kiểm định t một mẫu (H0: mean = 500000):\n")
cat("t-value:", round(t_test$statistic, 2), "\n")
cat("p-value:", format(t_test$p.value, scientific = FALSE), "\n")
cat("Kết luận: ", ifelse(t_test$p.value < 0.05, "Bác bỏ H0 (trung bình khác 500000)", "Không bác bỏ H0 (trung bình không khác 500000)"), "\n")

```

Trong phân tích dữ liệu ủng hộ bão Yagi, kiểm định t giúp trả lời câu hỏi: “Liệu trung bình ủng hộ có đạt hoặc vượt mức kỳ vọng (500,000) không?” Kết quả (trung bình khác 500,000) cho thấy chiến dịch gây quỹ hiệu quả hơn dự kiến.

Giả thuyết:
  H₀: Trung bình tổng thể = 500,000.
  H₁: Trung bình tổng thể ≠ 500,000.

Có thể thấy: Kiểm định t một mẫu giúp xác nhận trung bình ủng hộ (~685,991) cao hơn mục tiêu 500,000, cho thấy chiến dịch gây quỹ thành công về tổng thể.

```{r}
# Chuẩn bị dữ liệu (liên quan đến cả z-score và hồi quy tuyến tính)
# - date_clean và days_since_start dùng cho hồi quy
# - bank dùng cho hồi quy
all$date_clean <- as.Date(all$date, format = "%d/%m", errors = "coerce")
all$days_since_start <- as.numeric(all$date_clean - min(all$date_clean, na.rm = TRUE))
all$bank <- as.factor(all$bank)
```

```{r}
# PHẦN Z-SCORE: Tính z-score và loại bỏ ngoại lệ
# Tính z-score cho cột money
all$z_score <- (all$money - mean(all$money, na.rm = TRUE)) / sd(all$money, na.rm = TRUE)
# Xác định ngoại lệ (|z-score| > 3)
all$is_outlier <- abs(all$z_score) > 3

# In số lượng ngoại lệ
cat("Số lượng giao dịch ngoại lệ (Z-score):", sum(all$is_outlier, na.rm = TRUE), "\n")

```
Lọc ra được 1000 ngoại lệ
```{r}
# Lọc các giao dịch ngoại lệ để kiểm tra
outliers <- all[all$is_outlier, c("date", "bank", "id", "money", "desc", "z_score")]
print(outliers)

# Loại bỏ các giao dịch ngoại lệ
all_clean <- all[!all$is_outlier, ]
```

```{r}
# Kiểm tra kích thước dữ liệu
cat("Kích thước dữ liệu gốc (Z-score):", nrow(all), "\n")
cat("Kích thước dữ liệu sau khi loại bỏ ngoại lệ (Z-score):", nrow(all_clean), "\n")

```
Kích thước trước và sau khi bỏ ngoại lệ đã giảm, tuy không nhiều nhưng những ngoại lệ này ảnh hướng rất lớn tới bộ dữ liệu về sau

```{r}
# Thống kê cho cột money của dữ liệu mới (tương tự như dữ liệu gốc)
money_summary_clean <- c(
  Min = format(min(all_clean$money, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Q1 = format(quantile(all_clean$money, 0.25, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Median = format(median(all_clean$money, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Mean = format(round(mean(all_clean$money, na.rm = TRUE)), scientific = FALSE, trim = TRUE),
  Q3 = format(quantile(all_clean$money, 0.75, na.rm = TRUE), scientific = FALSE, trim = TRUE),
  Max = format(max(all_clean$money, na.rm = TRUE), scientific = FALSE, trim = TRUE)
)
print("Thống kê cột money (dữ liệu đã làm sạch):")
print(money_summary_clean)

```
Sau khi bỏ ngoại lệ, Mean đã giảm chỉ còn 536914, còn Max thì từ 10 tỷ giảm xuống chỉ còn khoảng 42 triệu.
```{r}
# Thống kê mô tả cho các cột còn lại (date, bank, id, desc) của dữ liệu mới
all_clean$id <- as.character(all_clean$id)  # Chuyển id thành character để đồng bộ định dạng
stat_desc_clean <- summary(all_clean[, c("date", "bank", "id", "desc")])
print(stat_desc_clean)

```
Thống kê mô tả của dữ liệu mới cho thấy các cột khác như date, bank, id, và desc không bị ảnh hưởng đáng kể về phân phối, ví dụ số lượng giao dịch của từng ngân hàng vẫn tương đối đồng đều, chỉ giảm nhẹ do loại bỏ ngoại lệ

```{r}
# PHẦN HỒI QUY TUYẾN TÍNH: Chạy mô hình hồi quy
# Hồi quy trên dữ liệu gốc
model_original <- lm(money ~ bank + days_since_start, data = all)
cat("Kết quả hồi quy trên dữ liệu gốc (Hồi quy tuyến tính):\n")
summary(model_original)

```
R-squared chỉ đạt 0.001194%, nghĩa là mô hình chỉ giải thích được 0.001194% biến thiên của số tiền giao dịch, một con số cực kỳ nhỏ.
Sai số chuẩn của residuals là 14.04 triệu VND, một giá trị rất lớn, phản ánh rằng các giá trị dự đoán của mô hình có độ lệch lớn so với thực tế.
Cụ thể, các hệ số trong model_original không ý nghĩa thống kê, với bankBIDV (275,380 VND, p = 0.0948), cho thấy giao dịch từ BIDV có vẻ cao hơn Agri 275,380 VND nhưng không đủ ý nghĩa (p > 0.05), bankVCB (-66,382 VND, p = 0.3907) và bankVietin (-192,187 VND, p = 0.0962).
Số tiền có xu hướng giảm 12,852 VND mỗi ngày.

```{r}
# Hồi quy trên dữ liệu đã làm sạch (sau khi loại bỏ ngoại lệ bằng z-score)
model_clean <- lm(money ~ bank + days_since_start, data = all_clean)
cat("Kết quả hồi quy trên dữ liệu đã làm sạch (Hồi quy tuyến tính):\n")
summary(model_clean)

```
Cải thiện đáng kể. R-squared tăng lên 0.05783%, tuy vẫn thấp nhưng đã tăng gấp nhiều lần so với dữ liệu gốc, cho thấy mô hình giải thích tốt hơn sự biến thiên của money.
Sai số chuẩn của residuals giảm mạnh xuống 1.498 triệu VND, phản ánh rằng các giá trị dự đoán của mô hình sát với thực tế hơn.
Số tiền giao dịch giảm trung bình 20,043 VND mỗi ngày.
```{r}
# 1. Histogram của money
ggplot() +
  geom_histogram(aes(x = all$money, fill = "Dữ liệu gốc"), alpha = 0.4, bins = 50) +
  geom_histogram(aes(x = all_clean$money, fill = "Dữ liệu đã làm sạch"), alpha = 1, bins = 50) +
  scale_x_log10(labels = scales::comma) +
  labs(title = "Phân phối của Money trước và sau khi loại bỏ ngoại lệ (Z-score)",
       x = "Money (VND, log scale)", y = "Số lượng giao dịch",
       fill = "Loại dữ liệu") +
  theme_minimal()

```
Biểu đồ histogram minh họa sự thay đổi phân phối của biến money (VND, thang log) trước và sau khi làm sạch bằng Z-score, với dữ liệu gốc (màu xanh nhạt) và dữ liệu đã xử lý (màu hồng). Trục X là giá trị money từ 100 đến 100,000,000 VND, trục Y là số lượng giao dịch.
Trong dữ liệu gốc, phân phối lệch phải mạnh, tập trung nhiều giao dịch ở mức 1,000 đến 10,000,000 VND, đỉnh tại 1,000,000 VND (~1.5 triệu giao dịch), nhưng tồn tại ngoại lệ ở cả hai đầu (từ 100 đến hơn 100 triệu VND), gây nhiễu cho mô hình hồi quy.

Sau khi loại bỏ ngoại lệ bằng Z-score, phân phối thu hẹp, đuôi dài biến mất, đỉnh tần số giảm nhẹ (~1.2 triệu), và phân phối trở nên gần chuẩn hơn. Điều này giúp mô hình hồi quy hoạt động hiệu quả hơn, thể hiện qua việc sai số chuẩn giảm từ 14.04 triệu xuống 1.498 triệu VND.

Histogram được chọn vì thể hiện rõ tác động tích cực của việc làm sạch dữ liệu đối với phân phối và mô hình hóa.
```{r}
# 2. Boxplot của money theo ngân hàng
ggplot() +
  geom_boxplot(data = all, aes(x = bank, y = money, fill = "Dữ liệu gốc"), alpha = 1) +
  geom_boxplot(data = all_clean, aes(x = bank, y = money, fill = "Dữ liệu đã làm sạch"), alpha = 1) +
  scale_y_log10(labels = scales::comma) +
  labs(title = "Boxplot của Money theo Ngân hàng trước và sau khi loại bỏ ngoại lệ (Z-score)",
       x = "Ngân hàng", y = "Money (VND, log scale)",
       fill = "Loại dữ liệu") +
  theme_minimal()

```
Boxplot thể hiện sự so sánh money (thang log) giữa các ngân hàng Agri, BIDV, VCB và Vietin, trước (xanh nhạt) và sau (hồng) khi loại bỏ ngoại lệ bằng Z-score. Trục X là tên ngân hàng, trục Y là giá trị money từ 100 đến 100,000,000 VND.

Ở dữ liệu gốc, cả 4 ngân hàng có phạm vi rất rộng, nhiều ngoại lệ đặc biệt ở mức cao, khiến hộp (IQR) méo mó và khó so sánh. Sau khi làm sạch, phạm vi thu hẹp còn 10,000 đến 10,000,000 VND, ngoại lệ bị loại bỏ, trung vị và IQR giữ nguyên, giúp nhận diện rõ hơn sự khác biệt: Vietin cao nhất (~2 triệu VND), Agri thấp nhất (~1 triệu VND), BIDV và VCB ở giữa.

Boxplot minh họa trực quan sự khác biệt giữa các ngân hàng, phù hợp với kết quả hồi quy sau làm sạch, nơi BIDV (+235,710 VND) và VCB (+78,185 VND) cao hơn Agri, còn Vietin không khác biệt đáng kể. Việc làm sạch giúp giảm nhiễu, làm rõ hơn sự khác biệt thực.
```{r}
# 3. Biểu đồ phân tán của money theo days_since_start
ggplot() +
  geom_point(data = all, aes(x = days_since_start, y = money, color = "Dữ liệu gốc"), alpha = 0.3) +
  geom_point(data = all_clean, aes(x = days_since_start, y = money, color = "Dữ liệu đã làm sạch"), alpha = 0.3) +
  scale_y_log10(labels = scales::comma) +
  labs(title = "Money theo Days Since Start trước và sau khi loại bỏ ngoại lệ (Z-score & Hồi quy)",
       x = "Số ngày kể từ ngày đầu tiên", y = "Money (VND, log scale)",
       color = "Loại dữ liệu") +
  theme_minimal()

```
Stripplot minh họa mối quan hệ giữa money (thang log) và days_since_start (0–15 ngày), trước (xanh nhạt) và sau (hồng) khi làm sạch. Trục X là số ngày từ 01/09/2024, trục Y là money từ 100 đến 100 triệu VND.

Trước làm sạch, money phân tán rộng, nhiều ngoại lệ, không có xu hướng rõ ràng theo ngày – phù hợp với hệ số hồi quy không ý nghĩa (-12,852 VND, p = 0.2501). Sau làm sạch, dữ liệu tập trung hơn (1,000–10 triệu VND), và xu hướng giảm nhẹ trở nên rõ ràng: money giảm trung bình ~20,043 VND mỗi ngày (p < 0.001).

Stripplot làm nổi bật xu hướng này, xác nhận kết quả hồi quy sau làm sạch, hỗ trợ khuyến nghị tập trung vào các ngày đầu (01–03/09/2024) để tối ưu số tiền ủng hộ.
```{r}
# Trích xuất hệ số và khoảng tin cậy từ model_original và model_clean
# Sử dụng tidy() để lấy hệ số, sai số chuẩn, và tính khoảng tin cậy 95%
coef_original <- tidy(model_original, conf.int = TRUE, conf.level = 0.95)
coef_clean <- tidy(model_clean, conf.int = TRUE, conf.level = 0.95)

# Thêm cột để phân biệt giữa hai mô hình
coef_original$model <- "Dữ liệu gốc"
coef_clean$model <- "Dữ liệu đã làm sạch"

# Kết hợp dữ liệu từ hai mô hình
coef_data <- rbind(coef_original, coef_clean)

# Loại bỏ hệ số chặn (Intercept) để tập trung vào các biến độc lập
coef_data <- coef_data[coef_data$term != "(Intercept)", ]

coef_data$term <- factor(coef_data$term, levels = c("bankBIDV", "bankVCB", "bankVietin", "days_since_start"),
                         labels = c("Ngân hàng BIDV", "Ngân hàng VCB", "Ngân hàng Vietin", "Số ngày từ ngày đầu"))

# Vẽ Coefficient Plot
ggplot(coef_data, aes(x = estimate, y = term, color = model)) +
  geom_point(position = position_dodge(width = 0.5), size = 3) +
  geom_errorbarh(aes(xmin = conf.low, xmax = conf.high), 
                 position = position_dodge(width = 0.5), height = 0.2) +  
  geom_vline(xintercept = 0, linetype = "dashed", color = "black") +  
  labs(title = "Biểu đồ Hệ số Hồi quy: Dữ liệu Gốc vs Dữ liệu Làm sạch",
       x = "Hệ số (VND)",
       y = "Biến độc lập",
       color = "Loại dữ liệu") +
  scale_color_manual(values = c("Dữ liệu gốc" = "lightblue", "Dữ liệu đã làm sạch" = "pink")) +
  theme_minimal() +
  theme(legend.position = "bottom")

```
Biểu đồ hệ số hồi quy so sánh dữ liệu gốc và dữ liệu làm sạch cho ba ngân hàng cho thấy ảnh hưởng rõ rệt của việc làm sạch.

Với Ngân hàng Vietin, hệ số hồi quy đều dương, nhưng giảm từ ~4e-05 xuống ~2e-05 sau khi làm sạch, với khoảng tin cậy hẹp và ổn định. VCB có hệ số âm ở cả hai bộ dữ liệu, nhưng sau làm sạch gần bằng 0 và kém ổn định hơn do khoảng tin cậy rộng. BIDV có hệ số gần 0 trong cả hai, từ -1e-05 (gốc) lên 1e-05 (làm sạch), với khoảng tin cậy tương đối ổn.

Tổng thể, làm sạch dữ liệu giúp giảm biên độ hệ số, làm kết quả giữa các ngân hàng đồng nhất hơn và tăng độ tin cậy phân tích bằng cách giảm nhiễu.
```{r}


```

```{r}
# CHUẨN BỊ DỮ LIỆU CHO PHÂN CỤM KMEANS
# Ta chỉ dùng cột 'money' cho đơn giản (có thể thêm days_since_start nếu muốn)
money_scaled <- scale(all_clean$money)

# Xác định số cụm bằng Elbow method
wss <- sapply(1:10, function(k){
  kmeans(money_scaled, centers = k, nstart = 10)$tot.withinss
})
plot(1:10, wss, type = "b", pch = 19, frame = FALSE,
     xlab = "Số cụm K", ylab = "Tổng bình phương khoảng cách (WSS)",
     main = "Elbow Method để chọn số cụm")

# Giả sử bạn chọn K = 3 (sau khi nhìn elbow)
set.seed(123)
km_result <- kmeans(money_scaled, centers = 4, nstart = 10)

# Gắn nhãn cụm vào data
all_clean$cluster <- factor(km_result$cluster)

ggplot(all_clean, aes(x = 1:nrow(all_clean), y = money, color = cluster)) +
  geom_point() +
  labs(title = "Phân bố tiền theo cụm KMeans", x = "Giao dịch", y = "Số tiền")

library(dplyr)

cluster_summary <- all_clean %>%
  group_by(cluster) %>%
  summarise(
    SoLuong = n(),
    Min_money = min(money, na.rm = TRUE),
    Max_money = max(money, na.rm = TRUE),
    Mean_money = round(mean(money, na.rm = TRUE)),
    Median_money = median(money, na.rm = TRUE),
    Total_money = sum(money, na.rm = TRUE)
  )

print(cluster_summary)

```

## Phân tích Random Forest

```{r}
library(randomForest)
library(caret)
library(ggplot2)
library(dplyr)

# Chuẩn bị dữ liệu
data_rf <- all_clean[, c("money", "bank", "days_since_start")]
set.seed(123)
trainIndex <- createDataPartition(data_rf$money, p = 0.7, list = FALSE)
train_data <- data_rf[trainIndex, ]
test_data <- data_rf[-trainIndex, ]

# Kiểm tra dữ liệu
cat("Kích thước tập huấn luyện:", dim(train_data), "\n")
cat("Kích thước tập kiểm tra:", dim(test_data), "\n")

```

Xây dựng mô hình Random Forest
Hồi quy Random Forest (rf_tuned)
Dự đoán money với mtry tối ưu hóa qua kiểm định chéo 5-fold.


```{r}
# Cấu hình và huấn luyện
control <- trainControl(method = "cv", number = 5, search = "grid")
tune_grid <- expand.grid(.mtry = seq(1, ncol(train_data)-1, by = 1))
set.seed(123)
rf_tuned <- train(money ~ ., data = train_data, method = "rf", trControl = control, 
                  tuneGrid = tune_grid, ntree = 100)

# Hiệu suất
predictions_tuned <- predict(rf_tuned, test_data)
mse_tuned <- mean((test_data$money - predictions_tuned)^2)
rmse_tuned <- sqrt(mse_tuned)
r_squared_tuned <- cor(test_data$money, predictions_tuned)^2
cat("Hồi quy RF - RMSE:", round(rmse_tuned, 2), "\n")
cat("Hồi quy RF - R²:", round(r_squared_tuned, 3), "\n")
cat("mtry tối ưu:", rf_tuned$bestTune$mtry, "\n")
```
## Biểu đồ trực quan hóa
1. Biểu đồ hộp: Phân phối số tiền thực tế
```{r}
ggplot(all_clean, aes(x = bank, y = money, fill = bank)) +
  geom_boxplot() +
  theme_minimal() +
  labs(title = "Phân phối số tiền thực tế theo ngân hàng", x = "Ngân hàng", y = "Số tiền (VND)") +
  theme(legend.position = "none", axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(labels = scales::comma)
```
Hiển thị phân phối money theo bank trong all_clean.
Vai trò: Cung cấp ngữ cảnh về dữ liệu thực tế, giúp so sánh với dự đoán (Hình 2, 3).

2. Biểu đồ phân tán: Thực tế vs dự đoán
```{r}
pred_actual_tuned <- data.frame(Actual = test_data$money, Predicted = predictions_tuned)
ggplot(pred_actual_tuned, aes(x = Actual, y = Predicted)) +
  geom_point(alpha = 0.5, color = "blue") +
  geom_abline(slope = 1, intercept = 0, color = "red") +
  theme_minimal() +
  labs(title = "Giá trị thực tế so với dự đoán", x = "Thực tế (VND)", y = "Dự đoán (VND)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma)
```
So sánh money (thực tế) và predicted_money (dự đoán từ rf_tuned) trên tập kiểm tra.
Vai trò: Đánh giá hiệu suất dự đoán của Random Forest, thể hiện RMSE = 1,482,475 (sai số lớn) và R² = 0.001 (mô hình không giải thích tốt).


3. Biểu đồ đường: Xu hướng số tiền dự đoán
```{r}
new_data_banks$bank <- factor(new_data_banks$bank, levels = c("Vietcombank", "BIDV", "Techcombank"))
new_data_banks$predicted_money <- round(new_predictions_banks, 2)
ggplot(new_data_banks, aes(x = days_since_start, y = predicted_money, color = bank)) +
  geom_line() +
  geom_point(size = 2) +
  theme_minimal() +
  labs(title = "Xu hướng số tiền dự đoán", x = "Ngày kể từ bắt đầu", y = "Số tiền dự đoán (VND)", color = "Ngân hàng") +
  facet_wrap(~bank, ncol = 1) +
  scale_y_continuous(labels = scales::comma)
```
Hiển thị xu hướng predicted_money theo days_since_start cho mỗi ngân hàng trong new_data_banks.
Vai trò: Phân tích xu hướng dự đoán theo thời gian, hỗ trợ chiến lược kêu gọi ủng hộ.


4. Biểu đồ tầm quan trọng biến
```{r}
rf_model_tuned <- randomForest(money ~ ., data = train_data, ntree = 100, mtry = rf_tuned$bestTune$mtry, importance = TRUE)
importance_df <- as.data.frame(importance(rf_model_tuned))
importance_df$Variable <- rownames(importance_df)
ggplot(importance_df, aes(x = reorder(Variable, `%IncMSE`), y = `%IncMSE`)) +
  geom_bar(stat = "identity", fill = "blue") +
  coord_flip() +
  theme_minimal() +
  labs(title = "Tầm quan trọng của biến (Hồi quy RF)", x = "Biến", y = "% Tăng MSE")
```
Hiển thị tầm quan trọng của bank và days_since_start dựa trên %IncMSE.
Vai trò: Phản ánh cơ chế Random Forest, giải thích mtry = 2 và R² = 0.001 thấp (biến yếu).

